<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test React JSON Schema Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <h1>Test React JSON Schema Form</h1>
        <div id="form-root"></div>
    </div>

    <!-- Try with more specific versions -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@rjsf/core@5.15.0/dist/rjsf-core.umd.js"></script>
    <script src="https://unpkg.com/@rjsf/utils@5.15.0/dist/rjsf-utils.umd.js"></script>
    <script src="https://unpkg.com/@rjsf/validator-ajv8@5.15.0/dist/rjsf-validator-ajv8.umd.js"></script>

    <script>
        console.log("=== Testing RJSF ===");
        
        // Check if everything loaded
        console.log("React:", typeof React);
        console.log("ReactDOM:", typeof ReactDOM);
        console.log("JSONSchemaForm:", typeof JSONSchemaForm);
        
        if (typeof JSONSchemaForm !== 'undefined') {
            console.log("JSONSchemaForm.default:", typeof JSONSchemaForm.default);
            console.log("JSONSchemaForm.validator:", typeof JSONSchemaForm.validator);
            
            try {
                const Form = JSONSchemaForm.default;
                const validator = JSONSchemaForm.validator.ajv8;
                
                const schema = {
                    type: "object",
                    properties: {
                        temp_celsius: { type: "number", title: "Temperature (°C)" },
                        temp_fahrenheit: { type: "number", title: "Temperature (°F)" }
                    }
                };
                
                const uiSchema = {
                    temp_fahrenheit: { "ui:readonly": true }
                };
                
                const formData = { temp_celsius: 20 };
                
                const element = React.createElement(Form, {
                    schema: schema,
                    uiSchema: uiSchema,
                    formData: formData,
                    validator: validator,
                    onChange: ({formData}) => {
                        console.log("Form changed:", formData);
                        if (formData.temp_celsius !== undefined) {
                            formData.temp_fahrenheit = formData.temp_celsius * 9/5 + 32;
                            ReactDOM.render(React.createElement(Form, {
                                schema: schema,
                                uiSchema: uiSchema,
                                formData: formData,
                                validator: validator,
                                onChange: arguments.callee
                            }), document.getElementById('form-root'));
                        }
                    }
                });
                
                ReactDOM.render(element, document.getElementById('form-root'));
                console.log("=== Form rendered successfully ===");
                
            } catch (error) {
                console.error("Error creating form:", error);
                document.getElementById('form-root').innerHTML = 
                    '<div class="alert alert-danger">Error: ' + error.message + '</div>';
            }
        } else {
            console.error("JSONSchemaForm not loaded");
            document.getElementById('form-root').innerHTML = 
                '<div class="alert alert-warning">JSONSchemaForm library failed to load</div>';
        }
    </script>
</body>
</html>
